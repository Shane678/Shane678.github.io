---
title: ES6 Array 之遍历数组的一些方法和方法对比
tags:
  - JavaScript
  - ES6
  - Array
author: Shane
img: 'https://myimagebed-1302088591.cos.ap-nanjing.myqcloud.com/%E6%96%87%E7%AB%A0%E7%89%B9%E5%BE%81%E5%9B%BE/15.jpg'
top: true
toc: true
summary: 全新 JavaScript 体系 ES6（ES2015）中遍历数组的一些方法和方法对比
comments: false
categories:
  - 前端
abbrlink: c18c9db4
date: 2020-05-27 22:54:38
---

## 遍历数组的方法对比{% github_emoji smiley %}

|          方法           | 简洁程度 | 对break/continue的支持 | 备注                                                         |
| :---------------------: | :------: | :--------------------: | ------------------------------------------------------------ |
|     [for](#1-for)     |    低    |   {% github_emoji heavy_check_mark %}   | 用于遍历数组，遍历过程受控，可以通过 break 和 continue 实现对遍历的控制 |
| [forEach](#2-forEach) |    高    |          {% github_emoji x %}           | ES5 新增。用于遍历数组，遍历过程不受控，会遍历完所有元素     |
|   [every](#3-every)   |    --    |          {% github_emoji x %}           | ES5 新增。用于遍历数组，遍历过程受控，通过设置函数`返回值`的真假，实现和 break、continue 相同的效果 |
|  [for in](#4-for-in)  |    --    |   {% github_emoji heavy_check_mark %}   | ES3 中就存在了。为 object 设计的，数组属于 object，也能用，但有瑕疵。遍历出的元素的索引是 string 类型的，而不是 number 类型。for in 会把自定义属性也遍历出来。 |
|  [for of](#5-for-of)  |    --    |                        | ES6 新增。用于遍历自定义的数据结构（该自定义的数据结构不是数组，也不是 object），同时也可以遍历数组。通过修改默认的遍历机制，配合 for of 的使用，使得 for of 的功能非常强大。 |

## 举例

### 1. for

```javascript
const arr = [1, 2, 3, 4, 5]
for (var i = 0; i < arr.length; i++) {
  console.log(arr[i])
}

/* 结果：
1
2
3
4
5
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
for (var i = 0; i < arr.length; i++) {
  if (arr[i] === 2) {
    break // for 循环中 break 有效
  }
  console.log(arr[i])
}

/* 结果：
1
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
for (var i = 0; i < arr.length; i++) {
  if (arr[i] === 2) {
    continue // for 循环中 continue 有效
  }
  console.log(arr[i])
}

/* 结果：
1
3
4
5
*/
```

### 2. forEach

```javascript
const arr = [1, 2, 3, 4, 5]
arr.forEach(function (item) {
  console.log(item)
})

/* 结果：
1
2
3
4
5
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
arr.forEach(function (item) {
  if (item === 2) {
    break // 报错：Unsyntactic break
  }
  console.log(item)
})
```

```javascript
const arr = [1, 2, 3, 4, 5]
arr.forEach(function (item) {
  if (item === 2) {
    continue // 报错：Unsyntactic continue
  }
  console.log(item)
})
```

相比于 for，forEach 的写法更加简洁，但是它不支持 break 和 continue，它所遍历的是从头到尾的每个元素。

拓展：

```javascript
// 声明一个长度为 5 的数组 array
let array = Array(5)
// 给数组的所有元素赋值为 1
array.forEach(function (item) {
  item = 1
})
console.log(array)

/* 结果：
(5) [empty × 5]
*/
```

可见，forEach 不能给数组元素赋值。

### 3. every

特性：every 遍历数组时，是否继续往下遍历，取决于函数的返回值，返回值为 true 时继续遍历，返回值为 false 时结束遍历，默认的返回值为 false。

```javascript
const arr = [1, 2, 3, 4, 5]
arr.every(function (item) {
  console.log(item) 
  // 函数返回值默认为 false，因此遍历出第一个元素后就结束遍历
})

/* 结果：
1
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
arr.every(function (item) {
  console.log(item)
  return true // 函数返回值为 true，表示继续遍历
})

/* 结果：
1
2
3
4
5
*/
```

上面代码块中函数返回 true 时，every 也能遍历所有元素了，看上去和 forEach 的行为一样。你可能会问，既然在这个时候 every 和 forEach 的行为很像了，那为什么还要新增 every 这个 API 呢？因为我们上面说过，forEach 有弊端，forEach 是不受控的，如果你用 forEach，它必须从头遍历到尾，它不支持 break 和 continue，而 every 虽然也不支持 break 和 continue，但 every 中可以实现和 break、continue 相同的效果，如何实现呢？其实，every 能不能向下遍历取决于函数的返回值，想要达到`break`的效果，可以使用`return false`，想要达到`continue`的效果，可以使用`return true`，所以说 every 是受控的。

```javascript
const arr = [1, 2, 3, 4, 5]
arr.every(function (item) {
  if (item === 2) {
	return false // 结束函数的执行，不再继续遍历，相当于实现了 break 的效果
  }
  console.log(item)
  return true
})

/* 结果：
1
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
arr.every(function (item) {
  if (item === 2) {
    // 不做处理，相当于实现了 continue 的效果
  } else {
    console.log(item)
  }
  return true
})

/* 结果：
1
3
4
5
*/
```

### 4. for in

for in 是为可遍历的 object 做遍历的，而不是为数组，只是数组也属于 object，并且数组是可遍历的，所以也能用 for in 遍历，但是用 for in 遍历数组会有瑕疵。

```javascript
const arr = [1, 2, 3, 4, 5]
for (var index in arr) {
  console.log(index, arr[index])
}

/* 结果：
0 1
1 2
2 3
3 4
4 5
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
arr.pro = 8 // 为 arr 数组添加属性 pro（arr 是数组，数组是对象，对象上可以挂属性）
for (var index in arr) { 
  console.log(index, arr[index])
}

/* 结果：
0 1
1 2
2 3
3 4
4 5
pro 8
*/
```

可见，数组的索引不一定是数字，也可以是字符串。用 for in 遍历数组，如果数组上挂载了属性，也会被遍历出来，导致和我们的预期不同，这就是用 for in 遍历数组的瑕疵。

```javascript
const arr = [1, 2, 3, 4, 5]
arr.pro = 8
for (var index in arr) { // 使用for in遍历，元素的索引是 string 类型的，而不是 number 类型。即这里的 index 是字符串类型
  if (index == 2) { // 左边 index 是 string 类型，右边 2 是 number 类型（注意：== 只比较值，不比较类型；而 === 既比较类型，也比较值，只要类型不同就返回 false）
    break // for in 中支持 break
  }
  console.log(index, arr[index])
}

/* 结果：
0 1
1 2
*/
```

```javascript
const arr = [1, 2, 3, 4, 5]
arr.pro = 8
for (var index in arr) { // 使用for in遍历，元素的索引是 string 类型的，而不是 number 类型。即这里的 index 是字符串类型
  if (index == 2) { // 左边 index 是 string 类型，右边 2 是 number 类型（注意：== 只比较值，不比较类型；而 === 既比较类型，也比较值，只要类型不同就返回 false）
    continue // for in 中支持 continue
  }
  console.log(index, arr[index])
}

/* 结果：
0 1
1 2
3 4
4 5
pro 8
*/
```

上面的 if 条件判断中，如果想使用`===`，可以将`index == 2`换成`index * 1 === 2`或者`+index === 2`或者`index === '2'`

字符串中只有数字时，可以通过乘 1 或在字符串前加个加号将字符串转换为 number 类型：

```javascript
var test = '00023' // 字符串中只有数字
var test1 = test * 1 // 乘以 1 转换成 number 类型
var test2 = +test // 前面加个加号转换成 number 类型
console.log(test, typeof (test)) // 00023 string
console.log(test1, typeof (test1)) // 23 "number"
console.log(test2, typeof (test2)) // 23 "number"
```

### 5. for of

for of 用于遍历自定义的数据结构（该自定义的数据结构不是数组，也不是 object），同时也可以遍历数组。

#### 5.1 遍历数组

```javascript
const arr = [1, 2, 3, 4, 5]
for (let item of arr) {
  console.log(item)
}

/* 结果：
1
2
3
4
5
*/
```

#### 5.2 遍历自定义的数据结构

```javascript
// 假设有 A、B、C 三类商品，每类商品下有不同价格的商品，现就价格进行如下定义：
const Price = {
  A: [2.3, 1.5, 4.5],
  B: [3, 5],
  C: [0.8, 0.5, 1.2]
}
```

如果想要找出每类商品中的最低价，该怎么实现呢？

我们先用`for in`遍历

```javascript
for (let key in Price) {
  console.log(key, Price[key])
}

/* 结果：
A (3) [2.3, 1.5, 4.5]
B (2) [3, 5]
C (3) [0.8, 0.5, 1.2]
*/
```

如果想要`直接`遍历出各类商品中的最低价，`for in`无法实现，需要再做排序等其它操作。

我们再用`for of`遍历

```javascript
// to do
```

